<?xml version="1.0" encoding="utf-8" ?>
<essential:TransparentWindow
    x:Class="WinUI3Example.FlipWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:essential="using:WinUI3Package"
    xmlns:local="using:WinUI3Example"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    Title="FlipWindow"
    mc:Ignorable="d">

    <Canvas
        x:Name="RootCanvas"
        Width="{x:Bind WindowWidth}"
        Height="{x:Bind WindowHeight}">
        <Canvas.Resources>
            <Storyboard x:Name="ZIndexForwardAnimation">
                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="BackGrid" Storyboard.TargetProperty="(Canvas.ZIndex)">
                    <DiscreteObjectKeyFrame KeyTime="0:0:0.2" Value="2" />
                </ObjectAnimationUsingKeyFrames>
            </Storyboard>
            <Storyboard x:Name="ZIndexBackwardAnimation">
                <ObjectAnimationUsingKeyFrames Storyboard.TargetName="BackGrid" Storyboard.TargetProperty="(Canvas.ZIndex)">
                    <DiscreteObjectKeyFrame KeyTime="0:0:0.2" Value="0" />
                </ObjectAnimationUsingKeyFrames>
            </Storyboard>
        </Canvas.Resources>

        <Grid
            x:Name="BackShadowGrid"
            Canvas.Left="{x:Bind local:FlipWindow.GetCanvasLeftOffset(RootGrid.Width, RootCanvas.Width), Mode=OneWay}"
            Canvas.Top="{x:Bind local:FlipWindow.GetCanvasLeftOffset(RootGrid.Height, RootCanvas.Height), Mode=OneWay}"
            Width="{x:Bind ContentWidth}"
            Height="{x:Bind ContentHeight}" />

        <Grid
            x:Name="BackGrid"
            Canvas.Left="{x:Bind local:FlipWindow.GetCanvasLeftOffset(RootGrid.Width, RootCanvas.Width), Mode=OneWay}"
            Canvas.Top="{x:Bind local:FlipWindow.GetCanvasLeftOffset(RootGrid.Height, RootCanvas.Height), Mode=OneWay}"
            Width="{x:Bind ContentWidth}"
            Height="{x:Bind ContentHeight}"
            Canvas.ZIndex="0"
            CornerRadius="8">
            <essential:AcrylicVisual CornerRadius="8" />
            <StackPanel Padding="16" Spacing="8">
                <TextBlock FontSize="32" Text="Private Folder" />
                <CommandBar DefaultLabelPosition="Right">
                    <AppBarButton
                        Background="{ThemeResource AccentFillColorDefaultBrush}"
                        CornerRadius="16"
                        Icon="Add"
                        Label="Add new" />
                    <AppBarButton Icon="Copy" LabelPosition="Collapsed" />
                    <AppBarButton Icon="Paste" LabelPosition="Collapsed" />
                    <AppBarButton Icon="Cut" LabelPosition="Collapsed" />
                    <AppBarButton Icon="Rename" LabelPosition="Collapsed" />
                    <AppBarButton Icon="Share" LabelPosition="Collapsed" />
                    <AppBarButton Icon="Delete" LabelPosition="Collapsed" />

                    <AppBarSeparator />

                    <AppBarElementContainer VerticalAlignment="Center" VerticalContentAlignment="Center">
                        <DropDownButton Background="Transparent" BorderThickness="0">
                            <StackPanel Orientation="Horizontal" Spacing="4">
                                <SymbolIcon Symbol="Sort" />
                                <TextBlock Text="Sort" />
                            </StackPanel>
                            <DropDownButton.Flyout>
                                <MenuFlyout Placement="Bottom">
                                    <MenuFlyoutItem Text="Name" />
                                    <MenuFlyoutItem Text="Date modified" />
                                    <MenuFlyoutItem Text="Size" />
                                    <MenuFlyoutItem Text="Type" />
                                </MenuFlyout>
                            </DropDownButton.Flyout>
                        </DropDownButton>
                    </AppBarElementContainer>
                    <AppBarElementContainer VerticalAlignment="Center" VerticalContentAlignment="Center">
                        <DropDownButton Background="Transparent" BorderThickness="0">
                            <StackPanel Orientation="Horizontal" Spacing="4">
                                <FontIcon Glyph="&#xF0E2;" />
                                <TextBlock Text="View" />
                            </StackPanel>
                            <DropDownButton.Flyout>
                                <MenuFlyout Placement="Bottom">
                                    <MenuFlyoutItem Text="Extra large icons" />
                                    <MenuFlyoutItem Text="Large icons" />
                                    <MenuFlyoutItem Text="Small icons" />
                                    <MenuFlyoutItem Text="List" />
                                    <MenuFlyoutItem Text="Details" />
                                    <MenuFlyoutItem Text="Tiles" />
                                    <ToggleMenuFlyoutItem IsChecked="True" Text="Content" />
                                </MenuFlyout>
                            </DropDownButton.Flyout>
                        </DropDownButton>
                    </AppBarElementContainer>
                    <AppBarToggleButton Content="Details" LabelPosition="Collapsed">
                        <AppBarToggleButton.Icon>
                            <FontIcon Glyph="&#xE90D;" />
                        </AppBarToggleButton.Icon>
                    </AppBarToggleButton>
                </CommandBar>
            </StackPanel>

            <Button
                x:Name="GoBackButton"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Click="GoBackButton_Click">
                Go Back
            </Button>
        </Grid>

        <Grid
            x:Name="ShadowGrid"
            Canvas.Left="{x:Bind local:FlipWindow.GetCanvasLeftOffset(RootGrid.Width, RootCanvas.Width), Mode=OneWay}"
            Canvas.Top="{x:Bind local:FlipWindow.GetCanvasLeftOffset(RootGrid.Height, RootCanvas.Height), Mode=OneWay}"
            Width="{x:Bind ContentWidth}"
            Height="{x:Bind ContentHeight}" />

        <Grid
            x:Name="RootGrid"
            Canvas.Left="{x:Bind local:FlipWindow.GetCanvasLeftOffset(RootGrid.Width, RootCanvas.Width), Mode=OneWay}"
            Canvas.Top="{x:Bind local:FlipWindow.GetCanvasLeftOffset(RootGrid.Height, RootCanvas.Height), Mode=OneWay}"
            Width="{x:Bind ContentWidth}"
            Height="{x:Bind ContentHeight}"
            Canvas.ZIndex="1">
            <essential:AcrylicVisual CornerRadius="8" />

            <!--  NavigationView will leaks out to area when doing collapse and expand, we add a clip in code-behind  -->
            <NavigationView Margin="0,32,0,0" essential:NavigationViewHelper.ClipToBounds="True">
                <NavigationView.MenuItems>
                    <NavigationViewItem Content="Documents" Icon="Document" />
                    <NavigationViewItem Content="Downloads" Icon="Download" />
                    <NavigationViewItem Content="Music" Icon="MusicInfo" />
                    <NavigationViewItem Content="Pictures" Icon="Pictures" />
                    <NavigationViewItem Content="Videos" Icon="Video" />
                    <NavigationViewItemSeparator />
                    <NavigationViewItem Content="This PC">
                        <NavigationViewItem.Icon>
                            <FontIcon Glyph="&#xEC4E;" />
                        </NavigationViewItem.Icon>
                    </NavigationViewItem>
                    <NavigationViewItem Content="Networks">
                        <NavigationViewItem.Icon>
                            <FontIcon Glyph="&#xE968;" />
                        </NavigationViewItem.Icon>
                    </NavigationViewItem>
                </NavigationView.MenuItems>
                <StackPanel
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Spacing="16">
                    <Slider
                        MinWidth="400"
                        Header="Animation duration milliseconds: "
                        Maximum="3000"
                        Minimum="300"
                        Value="{x:Bind AnimationDuration, Mode=TwoWay}" />

                    <RadioButtons
                        Header="Rotation Axis:"
                        SelectedIndex="1"
                        SelectionChanged="RadioButtons_SelectionChanged">
                        <RadioButtons.Style>
                            <Style TargetType="RadioButtons">
                                <Setter Property="IsTabStop" Value="False" />
                                <Setter Property="TabNavigation" Value="Once" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="RadioButtons">
                                            <StackPanel>
                                                <ContentPresenter
                                                    x:Name="HeaderContentPresenter"
                                                    Margin="{ThemeResource RadioButtonsTopHeaderMargin}"
                                                    Content="{TemplateBinding Header}"
                                                    ContentTemplate="{TemplateBinding HeaderTemplate}"
                                                    Foreground="{ThemeResource RadioButtonsHeaderForeground}" />
                                                <ItemsRepeater xmlns:primitives="using:Microsoft.UI.Xaml.Controls.Primitives" x:Name="InnerRepeater">
                                                    <ItemsRepeater.Layout>
                                                        <StackLayout Orientation="Horizontal" Spacing="{ThemeResource RadioButtonsRowSpacing}" />
                                                    </ItemsRepeater.Layout>
                                                </ItemsRepeater>

                                                <VisualStateManager.VisualStateGroups>
                                                    <VisualStateGroup x:Name="CommonStates">
                                                        <VisualState x:Name="Normal" />
                                                        <VisualState x:Name="Disabled">
                                                            <VisualState.Setters>
                                                                <Setter Target="HeaderContentPresenter.Foreground" Value="{ThemeResource RadioButtonsHeaderForegroundDisabled}" />
                                                            </VisualState.Setters>
                                                        </VisualState>
                                                    </VisualStateGroup>
                                                </VisualStateManager.VisualStateGroups>
                                            </StackPanel>

                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </RadioButtons.Style>
                        <RadioButton Content="X" />
                        <RadioButton Content="Y" />
                        <RadioButton Content="Z" />
                    </RadioButtons>
                    <Button
                        x:Name="myButton"
                        HorizontalAlignment="Center"
                        Click="myButton_Click">
                        Click to rotate window
                    </Button>
                </StackPanel>

            </NavigationView>

            <local:FakeTitleBar
                x:Name="FakeTitleBar"
                Title="This is a demo window"
                Width="{x:Bind ContentWidth}"
                Height="32"
                VerticalAlignment="Top" />
        </Grid>
    </Canvas>

</essential:TransparentWindow>
